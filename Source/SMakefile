# SMakefile for TTX
# 
# TTX - Text Editor for AmigaOS
# A clean-room reimplementation of TurboText 2.0
#

# Program name
PROGRAM = TTX

# Source files
SRCS = ttx.c ttx_text.c ttx_commands.c ttx_block.c ttx_dfn.c

# Object files
OBJS = ttx.o ttx_text.o ttx_commands.o ttx_block.o ttx_dfn.o

# Compiler and linker
CC = sc
LINK = slink

# Default target
all: $(PROGRAM)

# Create the TTX executable
$(PROGRAM): $(OBJS)
	$(LINK) FROM sc:lib/c.o $(OBJS) TO $(PROGRAM) STRIPDEBUG NODEBUG LIB lib:small.lib sc:lib/sc.lib lib/seiso.lib lib:amiga.lib BATCH

# Compile the source files
.c.o:
	$(CC) $*.c OBJNAME=$*.o IDIR=include: 

# Compile TTX main file
ttx.o: ttx.c ttx.h
	$(CC) ttx.c OBJNAME=ttx.o IDIR=include: 

# Compile TTX text functions
ttx_text.o: ttx_text.c ttx.h
	$(CC) ttx_text.c OBJNAME=ttx_text.o IDIR=include: 

# Compile TTX command functions
ttx_commands.o: ttx_commands.c ttx.h
	$(CC) ttx_commands.c OBJNAME=ttx_commands.o IDIR=include: 

# Compile TTX block operations
ttx_block.o: ttx_block.c ttx.h
	$(CC) ttx_block.c OBJNAME=ttx_block.o IDIR=include: 

# Compile TTX definition file parser
ttx_dfn.o: ttx_dfn.c ttx.h
	$(CC) ttx_dfn.c OBJNAME=ttx_dfn.o IDIR=include: 

# Clean target
clean:
	Delete $(OBJS) $(PROGRAM) ttx.o ttx_text.o ttx_commands.o ttx_block.o ttx_dfn.o

# Install target
install:
	@echo "Installing TTX to /SDK/Tools/TTX/"
	@copy $(PROGRAM) to /SDK/Tools/TTX/$(PROGRAM) CLONE

# Dependencies
ttx.o: ttx.c ttx.h
ttx_text.o: ttx_text.c ttx.h

